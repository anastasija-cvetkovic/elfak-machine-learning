![Revisit consent button](https://cdn-cookieyes.com/assets/images/revisit.svg)

We value your privacy

We use cookies to enhance your browsing experience, serve personalised ads or content, and analyse our traffic. By clicking "Accept All", you consent to our use of cookies.

CustomiseReject AllAccept All

Powered by [Visit CookieYes website](https://www.cookieyes.com/product/cookie-consent/?ref=cypbcyb&utm_source=cookie-banner&utm_medium=fl-branding)

Customise Consent Preferences![](https://cdn-cookieyes.com/assets/images/close.svg)

We use cookies to help you navigate efficiently and perform certain functions. You will find detailed information about all cookies under each consent category below.

The cookies that are categorised as "Necessary" are stored on your browser as they are essential for enabling the basic functionalities of the site. ...Â Show more

NecessaryAlways Active

Necessary cookies are required to enable the basic features of this site, such as providing secure log-in or adjusting your consent preferences. These cookies do not store any personally identifiable data.

- Cookie

\_\_cf\_bm

- Duration

1 hour

- Description

This cookie, set by Cloudflare, is used to support Cloudflare Bot Management.


- Cookie

AWSALBCORS

- Duration

7 days

- Description

Amazon Web Services set this cookie for load balancing.


- Cookie

\_cfuvid

- Duration

session

- Description

Cloudflare sets this cookie to track users across sessions to optimize user experience by maintaining session consistency and providing personalized services


- Cookie

li\_gc

- Duration

6 months

- Description

Linkedin set this cookie for storing visitor's consent regarding using cookies for non-essential purposes.


- Cookie

\_\_hssrc

- Duration

session

- Description

This cookie is set by Hubspot whenever it changes the session cookie. The \_\_hssrc cookie set to 1 indicates that the user has restarted the browser, and if the cookie does not exist, it is assumed to be a new session.


- Cookie

\_\_hssc

- Duration

1 hour

- Description

HubSpot sets this cookie to keep track of sessions and to determine if HubSpot should increment the session number and timestamps in the \_\_hstc cookie.


- Cookie

wpEmojiSettingsSupports

- Duration

session

- Description

WordPress sets this cookie when a user interacts with emojis on a WordPress site. It helps determine if the user's browser can display emojis properly.


- Cookie

\_octo

- Duration

1 year

- Description

No description available.


- Cookie

logged\_in

- Duration

1 year

- Description

No description available.


- Cookie

\_\_Secure-YEC

- Duration

past

- Description

YouTube sets this cookie to stores the user's video player preferences using embedded YouTube video


- Cookie

\_\_eoi

- Duration

6 months

- Description

Description is currently not available.


- Cookie

AWSALBTGCORS

- Duration

7 days

- Description

No description available.


- Cookie

login-status-p

- Duration

past

- Description

Description is currently not available.


- Cookie

AWSALBTG

- Duration

7 days

- Description

No description available.


- Cookie

csrf\_token

- Duration

session

- Description

No description available.


- Cookie

token\_v2

- Duration

1 day

- Description

Description is currently not available.


- Cookie

D

- Duration

1 year

- Description

Description is currently not available.


- Cookie

PHPSESSID

- Duration

session

- Description

This cookie is native to PHP applications. The cookie stores and identifies a user's unique session ID to manage user sessions on the website. The cookie is a session cookie and will be deleted when all the browser windows are closed.


- Cookie

VISITOR\_PRIVACY\_METADATA

- Duration

6 months

- Description

YouTube sets this cookie to store the user's cookie consent state for the current domain.


- Cookie

cookietest

- Duration

session

- Description

The cookietest cookie is typically used to determine whether the user's browser accepts cookies, essential for website functionality and user experience.


- Cookie

\_\_Host-airtable-session

- Duration

1 year

- Description

This cookie is used to enable us to integrate the services of Airtable.


- Cookie

\_\_Host-airtable-session.sig

- Duration

1 year

- Description

This cookie is used to enable us to integrate the services of Airtable.


- Cookie

m

- Duration

1 year 1 month 4 days

- Description

Stripe sets this cookie for fraud prevention purposes. It identifies the device used to access the website, allowing the website to be formatted accordingly.


- Cookie

BIGipServer\*

- Duration

session

- Description

Marketo sets this cookie to collect information about the user's online activity and build a profile about their interests to provide advertisements relevant to the user.


- Cookie

\_\_cfruid

- Duration

session

- Description

Cloudflare sets this cookie to identify trusted web traffic.


- Cookie

\_GRECAPTCHA

- Duration

6 months

- Description

Google Recaptcha service sets this cookie to identify bots to protect the website against malicious spam attacks.


- Cookie

\_\_Secure-YNID

- Duration

6 months

- Description

Google cookie used to protect user security and prevent fraud, especially during the login process.


- Cookie

cookieyes-consent

- Duration

1 year

- Description

CookieYes sets this cookie to remember users' consent preferences so that their preferences are respected on subsequent visits to this site. It does not collect or store any personal information about the site visitors.


Functional

Functional cookies help perform certain functionalities like sharing the content of the website on social media platforms, collecting feedback, and other third-party features.

- Cookie

BCTempID

- Duration

10 minutes

- Description

No description available.


- Cookie

BCSessionID

- Duration

1 year 1 month 4 days

- Description

Blueconic sets this cookie as a unique identifier for the BlueConic profile.


- Cookie

lidc

- Duration

1 day

- Description

LinkedIn sets the lidc cookie to facilitate data center selection.


- Cookie

brw

- Duration

1 year

- Description

No description available.


- Cookie

brwConsent

- Duration

5 minutes

- Description

Description is currently not available.


- Cookie

WMF-Uniq

- Duration

1 year

- Description

Description is currently not available.


- Cookie

loom\_anon\_comment

- Duration

1 year

- Description

No description available.


- Cookie

loom\_referral\_video

- Duration

session

- Description

Description is currently not available.


- Cookie

VISITOR\_INFO1\_LIVE

- Duration

6 months

- Description

A cookie set by YouTube to measure bandwidth that determines whether the user gets the new or old player interface.


- Cookie

yt-remote-connected-devices

- Duration

Never Expires

- Description

YouTube sets this cookie to store the user's video preferences using embedded YouTube videos.


- Cookie

ytidb::LAST\_RESULT\_ENTRY\_KEY

- Duration

Never Expires

- Description

The cookie ytidb::LAST\_RESULT\_ENTRY\_KEY is used by YouTube to store the last search result entry that was clicked by the user. This information is used to improve the user experience by providing more relevant search results in the future.


- Cookie

yt-remote-device-id

- Duration

Never Expires

- Description

YouTube sets this cookie to store the user's video preferences using embedded YouTube videos.


- Cookie

yt-remote-session-name

- Duration

session

- Description

The yt-remote-session-name cookie is used by YouTube to store the user's video player preferences using embedded YouTube video.


- Cookie

yt-remote-fast-check-period

- Duration

session

- Description

The yt-remote-fast-check-period cookie is used by YouTube to store the user's video player preferences for embedded YouTube videos.


- Cookie

yt-remote-session-app

- Duration

session

- Description

The yt-remote-session-app cookie is used by YouTube to store user preferences and information about the interface of the embedded YouTube video player.


- Cookie

yt-remote-cast-available

- Duration

session

- Description

The yt-remote-cast-available cookie is used to store the user's preferences regarding whether casting is available on their YouTube video player.


- Cookie

yt-remote-cast-installed

- Duration

session

- Description

The yt-remote-cast-installed cookie is used to store the user's video player preferences using embedded YouTube video.


- Cookie

cp\_session

- Duration

3 months

- Description

Codepen sets this cookie for Help systems found in the website.


- Cookie

loid

- Duration

1 year 1 month 4 days

- Description

This cookie is set by the Reddit. The cookie enables the sharing of content from the website onto the social media platform.


Analytics

Analytical cookies are used to understand how visitors interact with the website. These cookies help provide information on metrics such as the number of visitors, bounce rate, traffic source, etc.

- Cookie

\_\_hstc

- Duration

6 months

- Description

Hubspot set this main cookie for tracking visitors. It contains the domain, initial timestamp (first visit), last timestamp (last visit), current timestamp (this visit), and session number (increments for each subsequent session).


- Cookie

hubspotutk

- Duration

6 months

- Description

HubSpot sets this cookie to keep track of the visitors to the website. This cookie is passed to HubSpot on form submission and used when deduplicating contacts.


- Cookie

\_ga

- Duration

1 year 1 month 4 days

- Description

Google Analytics sets this cookie to calculate visitor, session and campaign data and track site usage for the site's analytics report. The cookie stores information anonymously and assigns a randomly generated number to recognise unique visitors.


- Cookie

\_ga\_\*

- Duration

1 year 1 month 4 days

- Description

Google Analytics sets this cookie to store and count page views.


- Cookie

\_\_Host-psifi.analyticsTrace

- Duration

6 hours

- Description

Description is currently not available.


- Cookie

\_\_Host-psifi.analyticsTraceV2

- Duration

6 hours

- Description

Description is currently not available.


- Cookie

\_gh\_sess

- Duration

session

- Description

GitHub sets this cookie for temporary application and framework state between pages like what step the user is on in a multiple step form.


- Cookie

YSC

- Duration

session

- Description

YSC cookie is set by Youtube and is used to track the views of embedded videos on Youtube pages.


- Cookie

ajs\_anonymous\_id

- Duration

1 year

- Description

This cookie is set by Segment to count the number of people who visit a certain site by tracking if they have visited before.


- Cookie

vuid

- Duration

1 year 1 month 4 days

- Description

Vimeo installs this cookie to collect tracking information by setting a unique ID to embed videos on the website.


Performance

Performance cookies are used to understand and analyse the key performance indexes of the website which helps in delivering a better user experience for the visitors.

- Cookie

AWSALB

- Duration

7 days

- Description

AWSALB is an application load balancer cookie set by Amazon Web Services to map the session to the target.


- Cookie

acq

- Duration

past

- Description

Description is currently not available.


- Cookie

acq.sig

- Duration

past

- Description

Description is currently not available.


- Cookie

ptc

- Duration

2 years

- Description

No description available.


Advertisement

Advertisement cookies are used to provide visitors with customised advertisements based on the pages you visited previously and to analyse the effectiveness of the ad campaigns.

- Cookie

muc\_ads

- Duration

1 year 1 month 4 days

- Description

Twitter sets this cookie to collect user behaviour and interaction data to optimize the website.


- Cookie

guest\_id\_marketing

- Duration

1 year 1 month 4 days

- Description

Twitter sets this cookie to identify and track the website visitor.


- Cookie

guest\_id\_ads

- Duration

1 year 1 month 4 days

- Description

Twitter sets this cookie to identify and track the website visitor.


- Cookie

personalization\_id

- Duration

1 year 1 month 4 days

- Description

Twitter sets this cookie to integrate and share features for social media and also store information about how the user uses the website, for tracking and targeting.


- Cookie

guest\_id

- Duration

1 year 1 month 4 days

- Description

Twitter sets this cookie to identify and track the website visitor. It registers if a user is signed in to the Twitter platform and collects information about ad preferences.


- Cookie

bcookie

- Duration

1 year

- Description

LinkedIn sets this cookie from LinkedIn share buttons and ad tags to recognize browser IDs.


- Cookie

\_\_Secure-ROLLOUT\_TOKEN

- Duration

6 months

- Description

YouTube sets this cookie to manage feature rollout and experimentation. It helps Google control which new features or interface changes are shown to users as part of testing and staged rollouts, ensuring consistent experience for a given user during an experiment.


- Cookie

yt.innertube::nextId

- Duration

Never Expires

- Description

YouTube sets this cookie to register a unique ID to store data on what videos from YouTube the user has seen.


- Cookie

yt.innertube::requests

- Duration

Never Expires

- Description

YouTube sets this cookie to register a unique ID to store data on what videos from YouTube the user has seen.


- Cookie

session\_tracker

- Duration

session

- Description

This cookie is set by the Reddit. This cookie is used to identify trusted web traffic. It also helps in adverstising on the website.


- Cookie

edgebucket

- Duration

session

- Description

Reddit sets this cookie to save the information about a log-on Reddit user, for the purpose of advertisement recommendations and updating the content.


- Cookie

did

- Duration

1 year

- Description

Arbor sets this cookie to show targeted ads to site visitors.This cookie expires after 2 months or 1 year.


Uncategorised

Other uncategorised cookies are those that are being analysed and have not been classified into a category as yet.

No cookies to display.

Reject AllSave My PreferencesAccept All

Powered by [Visit CookieYes website](https://www.cookieyes.com/product/cookie-consent/?ref=cypbcyb&utm_source=cookie-banner&utm_medium=sl-branding)

[Skip to content](https://towardsdatascience.com/hac-hierarchical-agglomerative-clustering-is-it-better-than-k-means-4ff6f459e390/#wp--skip-link--target)

[Data Science](https://towardsdatascience.com/category/data-science/)

# HAC: Hierarchical Agglomerative Clustering. Is It Better Than K-Means?

A detailed look into the HAC algorithm together with Python code and several useful charts

[Saul Dobilas](https://towardsdatascience.com/author/solclover/)

May 9, 2021

10 min read

Share

### Machine Learning

![Hierarchical Agglomerative Clustering (HAC). Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/1UMN_2u9ODarWKgULW_cUnA.png)Hierarchical Agglomerative Clustering (HAC). Image by [author.](https://solclover.com/)

## Intro

If you want to be a successful Data Scientist, it is essential to understand how different Machine Learning algorithms work.

This story is part of the series that explains the nuances of each algorithm and provides a range of Python examples to help you build your own ML models.

## The story covers the following topics:

- The category of algorithms Hierarchical Agglomerative Clustering (HAC) belongs to.
- Details of how the HAC algorithm works.
- Python example, which uses HAC to cluster Australian cities.

## What category of algorithms does Hierarchical Agglomerative Clustering belong to?

The answer is hidden in its name. Since HAC is a clustering algorithm, it sits under the **Unsupervised** branch of Machine Learning.

Unsupervised techniques, in particular clustering, are often used for segmentation analysis or as a starting point in more complex projects that require an understanding of similarities between data points (e.g., customers, products, behaviors).

The below chart is my attempt to categorize a wide range of different algorithms. In many cases, an algorithm can be used to solve multiple types of problems. E.g., I placed Neural Networks in a category of their own due to their unique approach to Machine Learning. However, NNs can be used in a wide array of problems such as classification, regression, or as a component of reinforcement learning.

The below graph is **interactive,** so please click on different categories to **enlarge and reveal more** ðŸ‘‡ .

Important update for Chart Studio users

![Moon icon](https://plotly.com/moon.svg)![Sun icon](https://plotly.com/sun.svg)![Toggle indicator](https://plotly.com/circle.svg)

# Important Update for Chart Studio Users

Chart Studio has shut down

Chart Studio closed on October 31, 2025 at 5pm EDT. We've moved our focus to Plotly Studio and Plotly Cloud, which now serve as the home for AI-assisted visualizations and interactive data apps.

If you need to retrieve your Chart Studio data, please email [support@plotly.com](mailto:support@plotly.com) with the subject line "Chart Studio data request".

### What's next?

Plotly Studio and Plotly Cloud offer expanded capabilities for building and sharing interactive visualizations and data applications. Both platforms provide modern workflows for teams working with data. Get started with [Plotly Studio](https://plotly.com/studio/) or explore [Plotly Cloud](https://plotly.com/cloud/).

## Your data, two minutes.

- Generate complete visual applications containing expert, production-grade Python code, multiple visualization perspectives, interactive controls, and professional architecture automatically from your dataset in minutes.
- Detect patterns and unexpected relationships across domains and variables, producing visualizations that expand how you explore your data.
- Built on ten years of Plotly expertise, with checks that catch errors and add domain knowledge, so you get reliable data apps instead of messy AI code that breaks.

[Download Plotly Studio](https://plotly.com/downloads/)

![](<Base64-Image-Removed>)

![play-icon](https://plotly.com/purple-play-icon.svg)

Product

[Examples](https://plotly.com/examples/)

Community

Enterprise

[Pricing](https://plotly.com/pricing/)

Resources

Company

Marketo Forms 2 Cross Domain request proxy frame

## This page is used by Marketo Forms 2 to proxy cross domain AJAX requests.

_**If you enjoy Data Science and Machine Learning**, please [subscribe](https://solclover.com/subscribe) to get an email whenever I publish a new story._

## How does the Hierarchical Agglomerative Clustering (HAC) algorithm work?

### The basics

HAC is not as well-known as K-Means, but it is quite flexible and often easier to interpret. It uses a "bottom-up" approach, which means that each observation starts in its own cluster, and pairs of clusters are merged as one moves up the hierarchy.

To help illustrate this, I have created a few graphs. The first one demonstrates how the algorithm merges closest points one step at a time until there is only one cluster remaining.

![Hierarchical Agglomerative Clustering (HAC) in action. Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/1eJnNcuin2hVcJ_Els1_sgA.gif)Hierarchical Agglomerative Clustering (HAC) in action. Image by [author](https://solclover.com/).

Note, the above implementation of HAC uses â€˜averageâ€™ linkage, which I will explain later in this section.

The second graph is known as a **Dendrogram**. It gives the full picture of the path taken, moving from all individual points (bottom of the graph) to one single point/cluster (top of the graph).

![Hierarchical Agglomerative Clustering (HAC) Dendrogram. Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/1r7klEXFzpGd1T8GSiNisQA.png)Hierarchical Agglomerative Clustering (HAC) Dendrogram. Image by [author](https://solclover.com/).

Note, I have added a dotted horizontal line to indicate the number of clusters I have selected. In general, a good rule of thumb is to identify the largest section within the y-axis where you do not have vertical lines intersected by any horizontal lines. Let me explain further.

The value on the y-axis is the measure of closeness between points/clusters. The horizontal lines denote places where those points/clusters are being merged.

The above graph indicates that you may want to consider having 2 clusters since the largest distance with no cluster mergers is between 24 and 30 (30â€“24=6).

However, in this case, I decided to choose 4 clusters instead, which is a slightly less optimal solution (approx. 19.5â€“14.5=5). Hence, my clusters are red, bright green, blue, and Norfolk Island that sits in the corner on its own.

Here is what the clusters look like on a map:

![Australian city clustering with the HAC algorithm. Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/1tE4Sz_O-1ZCIT3Q9BDbDHw.png)Australian city clustering with the HAC algorithm. Image by [author](https://solclover.com/).

### Linkage types

There are multiple ways to link the points together. I used â€˜averageâ€™ linkage in the above example since it is easy to illustrate and understand. However, it is important to familiarize yourself with other linkage types too. Note, Python section at the end of this article will show you how to specify which linkage method you want to use.

- **â€˜Averageâ€™:** uses the average of the distances of each observation of the two sets, i.e., finds the mid-point between observations (as shown in the graphs).
- **â€˜Singleâ€™:** uses the minimum of the distances between all observations of the two sets, i.e., looks for the closest point within the cluster of points at that stage (instead of cluster mid-point used in â€˜averageâ€™).
- **â€˜Completeâ€™ or â€˜Maximumâ€™:** uses the maximum distance between all observations of the two sets. E.g., if the point is closer to the farthest point of Cluster A than the farthest point of Cluster B, then such a point would be added to Cluster A.
- **â€˜Wardâ€™:** minimizes the variance of the clusters being merged. This is very similar to minimizing Within Cluster Sum of Squares (WCSS) used by K-Means.

â€˜Wardâ€™ linkage is typically the one that is used most often. It is also the default option for sklearnâ€™s implementation of HAC, which we will explore in the Python section below.

### HAC advantage over K-Means clustering

The attractive part of using HAC is the ability to analyze dendrogram, which provides an insight into the similarity level between any two data points.

It only takes one glance at a dendrogram to see that Pearce, Bullsbrook is very â€˜distantâ€™ from Norfolk Island, while Sydney and Sydney Airport are quite close together. While this is fairly obvious given our location data, it becomes very beneficial when we use more abstract attributes.

In general, you can generate very similar clusters using HAC and K-Means, but having the ability to see the path of each data point, makes HAC more useful in analyzing similarities and differences between individual data points or clusters.

![](https://towardsdatascience.com/wp-content/uploads/2022/09/1vabxOXtQ4T034N_mscHSmQ.png)

## Hierarchical Agglomerative Clustering (HAC) in Python using Australian city location data

### Setup

We will use the following data and libraries:

- [Australian weather data from Kaggle](https://www.kaggle.com/jsphyg/weather-dataset-rattle-package)
- [Scikit-learn library](https://scikit-learn.org/stable/index.html) to perform [HAC clustering](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.AgglomerativeClustering.html?highlight=agglomerative%20clustering#sklearn.cluster.AgglomerativeClustering)
- [Scipy library](https://docs.scipy.org/doc/scipy/reference/index.html) to create a [dendrogram](https://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.hierarchy.dendrogram.html)
- [Plotly](https://plotly.com/python/) and [Matplotlib](https://matplotlib.org/) for data visualizations
- [Pandas](https://pandas.pydata.org/docs/) for data manipulation
- [Geopy](https://geopy.readthedocs.io/en/stable/), [Progressbar](https://pypi.org/project/progressbar/), and Time for collecting Australian city coordinates

Letâ€™s import all the libraries:

```python
from sklearn.cluster import AgglomerativeClustering # For HAC clustering
import scipy.cluster.hierarchy as sch # For HAC Denddrogram

import matplotlib.pyplot as plt # for data visualization
import plotly.graph_objects as go # for data visualization

import pandas as pd # for data manipulation
from geopy.geocoders import Nominatim # for getting city coordinates
from progressbar import ProgressBar # for displaying progress
import time # for adding time delays
```

Then we get the Australian weather data from Kaggle, which you can download following this link: [https://www.kaggle.com/jsphyg/weather-dataset-rattle-package](https://www.kaggle.com/jsphyg/weather-dataset-rattle-package).

We ingest the data and derive a few new variables, such as Location2, which has the right format to extract city coordinates using Geopy.

```python
# Set Pandas options to display more columns
pd.options.display.max_columns=50

# Read in the weather data csv
df=pd.read_csv('weatherAUS.csv', encoding='utf-8')

# Drop records where target RainTomorrow=NaN
df=df[pd.isnull(df['RainTomorrow'])==False]

# For other columns with missing values, fill them in with column mean
df=df.fillna(df.mean())

# Add spaces between multiple words in location names
df['Location2']=df['Location'].str.replace( r"([A-Z])", r" 1").str.strip()
# Update Location for Pearce RAAF so it can be found by geolocator
df['Location2']=df['Location2'].apply(lambda x: 'Pearce, Bullsbrook' if x=='Pearce R A A F' else x)

# Show a snaphsot of data
df
```

![A snippet of Kaggle's Australian weather data with some modifications. Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/1hRuWPERmAT2ZOUr8HnaZ4w.png)A snippet of [Kaggleâ€™s Australian weather data](https://www.kaggle.com/jsphyg/weather-dataset-rattle-package) with some modifications. Image by [author](https://solclover.medium.com/).

Since our original data only contains location (city) names and not coordinates, we will use Geopyâ€™s Nominatim to get those coordinates. Note that we add a sleep time of 1 second between each call not to overload the server.

```python
# Create a list of unique locations (cities)
loc_list=list(df.Location2.unique())

geolocator = Nominatim(user_agent="add-your-agent-name")
country ="Australia"
loc_res=[]

pbar=ProgressBar() # This will help us to show the progress of our iteration
for city in pbar(loc_list):
    loc = geolocator.geocode(city+','+ country)
    res = [city, loc.latitude, loc.longitude]
    loc_res = loc_res + [res]
    time.sleep(1) # sleep for 1 second before submitting the next query

# Add locations to a dataframe
df_loc=pd.DataFrame(loc_res, columns=['Loc', 'Latitude', 'Longitude'])

# Show data
df_loc
```

And this is the snippet of what we get in return:

![Australian city coordinates. Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/173HbzbTOe3lv0B9MOpErcQ.png)Australian city coordinates. Image by [author](https://solclover.com/).

Letâ€™s plot the cities on a map:

```python
# Create a figure
fig = go.Figure(data=go.Scattergeo(
        lat=df_loc['Latitude'],
        lon=df_loc['Longitude'],
        hovertext=df_loc['Loc'],
        mode = 'markers',
        marker_color = 'black',
        ))

# Update layout so we can zoom in on Australia
fig.update_layout(
        width=980,
        height=720,
        margin={"r":0,"t":10,"l":0,"b":10},
        geo = dict(
            scope='world',
            projection_type='miller',
            landcolor = "rgb(250, 250, 250)",
            center=dict(lat=-25.69839, lon=139.8813), # focus point
            projection_scale=6 # zoom in on
        ),
    )
fig.show()
```

![Australian cities on a map. Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/1yDPvvn2ukcQT-_XTCqLrsA.png)Australian cities on a map. Image by [author](https://solclover.com/).

### HAC clustering â€“ dendrogram

To decide on the number of clusters, we will first draw a dendrogram like the one we have analyzed earlier. Note, we will draw two of them, one using â€˜averageâ€™ linkage and another using â€˜wardâ€™ linkage so you can see the difference in the results.

**Average linkage:**

```python
# Select attributes
X = df_loc[['Latitude', 'Longitude']]

# Create a figure
plt.figure(figsize=(16,9), dpi=300)

# Create linkage
Z = sch.linkage(X, method='average', optimal_ordering=True) # note we use method='average'

# Specify cluster colors
sch.set_link_color_palette(['red', '#34eb34', 'blue', '#ae34eb'])

# Draw a dendrogram
sch.dendrogram(Z, leaf_rotation=90, leaf_font_size=10, labels=list(df_loc['Loc']),
               color_threshold=14.55, above_threshold_color='black')

# Add horizontal line
plt.axhline(y=14.55, c='grey', lw=1, linestyle='dashed')

# Show the plot
plt.show()
```

![HAC dendrogram using average linkage (same as above). Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/1r7klEXFzpGd1T8GSiNisQA.png)HAC dendrogram using **average** linkage (same as above). Image by [author](https://solclover.com/).

**Ward linkage:**

```python
# Select attributes
X = df_loc[['Latitude', 'Longitude']]

# Create a figure
plt.figure(figsize=(16,9), dpi=300)

# Create linkage
Z = sch.linkage(X, method='ward', optimal_ordering=True) # note, we use method='ward'

# Specify cluster colors
sch.set_link_color_palette(['red', '#34eb34', 'blue', '#ae34eb'])

# Draw a dendrogram
sch.dendrogram(Z, leaf_rotation=90, leaf_font_size=10, labels=list(df_loc['Loc']),
               color_threshold=25, above_threshold_color='black')

# Add horizontal line
plt.axhline(y=25, c='grey', lw=1, linestyle='dashed')

# Show the plot
plt.show()
```

![HAC dendrogram using ward linkage. Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/1ogrlSOpxkPodQ4XwnM85AA.png)HAC dendrogram using **ward** linkage. Image by [author](https://solclover.com/).

As you can see, we get quite different results when using the â€˜wardâ€™ linkage. The previous blue cluster has been split into two, and lonely Norfolk Island has been merged into the purple cluster.

### HAC clustering â€“ generating cluster labels

Since we have decided to have 4 clusters, letâ€™s run the scikit learnâ€™s HAC algorithm to generate cluster labels for both â€˜averageâ€™ and â€˜wardâ€™ linkage methods.

```python
# Set the model and its parameters
# note, options for linkage: {'ward', 'complete', 'average', 'single'}, default='ward'
modela4 = AgglomerativeClustering(n_clusters=4, affinity='euclidean', linkage='average')
modelw4 = AgglomerativeClustering(n_clusters=4, affinity='euclidean', linkage='ward')

# Fit HAC on our data
clusta4 = modela4.fit(X)
clustw4 = modelw4.fit(X)

# Attach cluster labels back to the location dataset
df_loc['Clusta4']=clusta4.labels_
df_loc['Clustw4']=clustw4.labels_

# Print data
df_loc
```

![A snippet of location data with cluster labels attached. Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/1einTqnFyxUGqiI84V0rE9w.png)A snippet of location data with cluster labels attached. Image by [author](https://solclover.com/).

Finally, letâ€™s draw the results on a map.

**Average linkage:**

```python
# Create a figure
fig = go.Figure(data=go.Scattergeo(
        lat=df_loc['Latitude'],
        lon=df_loc['Longitude'],
        hovertext=df_loc[['Loc', 'Clusta4']],
        mode = 'markers',
        marker=dict(colorscale=['#34eb34', 'blue', '#ae34eb', 'red']),
        marker_color = df_loc['Clusta4'],
        ))

# Update layout so we can zoom in on Australia
fig.update_layout(
        showlegend=False,
        width=980,
        height=720,
        margin={"r":0,"t":10,"l":0,"b":10},
        geo = dict(
            scope='world',
            projection_type='miller',
            landcolor = "rgb(250, 250, 250)",
            center=dict(lat=-25.69839, lon=139.8813), # focus point
            projection_scale=6 # zoom in on
        ),
    )
fig.show()
```

![HAC clustering of Australian cities using average linkage (same as above). Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/1tE4Sz_O-1ZCIT3Q9BDbDHw.png)HAC clustering of Australian cities using **average** linkage (same as above). Image by [author](https://solclover.com/).

**Ward linkage:**

To plot clusters using â€˜ward,â€™ we use the same Python code as above, except we change â€˜Clusta4â€™ with â€˜Clustw4â€™ in rows 5 and 8.

![HAC clustering of Australian cities using ward linkage. Image by author.](https://towardsdatascience.com/wp-content/uploads/2021/05/1ohZL8u9lnU0fSst5TjqUGw.png)HAC clustering of Australian cities using **ward** linkage. Image by [author](https://solclover.com/).

## Conclusion

The nice thing about Hierarchical Agglomerative Clustering is that it gives you visibility on the proximity of all the data points through a dendrogram. This becomes even more important when you take your clustering to multi-dimensional space by using more than two attributes.

To summarize, I want to reiterate what I said in my K-Means article: **clustering is rarely the end of your analysis; often, it is just the beginning.** Hence, make sure to explore how you can use your newly created clusters to improve your understanding of the data and see how it can aid the development of other types of models.

Have fun using HAC in your projects, and feel free to let me know if you have any questions or suggestions!

Cheers! ðŸ‘
**Saul Dobilas**

* * *

If you liked this article, you might also enjoy a detailed explanation of the inner workings of other types of clustering algorithms:

> [**K-Means Clustering â€“ A Comprehensive Guide to Its Successful Use in Python**](https://towardsdatascience.com/k-means-clustering-a-comprehensive-guide-to-its-successful-use-in-python-c3893957667d)
>
> [**DBSCAN Clustering Algorithm â€“ How to Build Powerful Density-Based Models**](https://towardsdatascience.com/dbscan-clustering-algorithm-how-to-build-powerful-density-based-models-21d9961c4cec)
>
> [**GMM: Gaussian Mixture Models â€“ How to Successfully Use It to Cluster Your Data?**](https://towardsdatascience.com/gmm-gaussian-mixture-models-how-to-successfully-use-it-to-cluster-your-data-891dc8ac058f)

* * *

Written By

Saul Dobilas

[See all from Saul Dobilas](https://towardsdatascience.com/author/solclover/)

[Clustering](https://towardsdatascience.com/tag/clustering/), [Data Science](https://towardsdatascience.com/tag/data-science/), [Machine Learning](https://towardsdatascience.com/tag/machine-learning/), [Python](https://towardsdatascience.com/tag/python/), [Unsupervised Learning](https://towardsdatascience.com/tag/unsupervised-learning/)

Share This Article

- [Share on Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ftowardsdatascience.com%2Fhac-hierarchical-agglomerative-clustering-is-it-better-than-k-means-4ff6f459e390%2F&title=HAC%3A%20Hierarchical%20Agglomerative%20Clustering.%20Is%20It%20Better%20Than%20K-Means%3F)
- [Share on LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Ftowardsdatascience.com%2Fhac-hierarchical-agglomerative-clustering-is-it-better-than-k-means-4ff6f459e390%2F&title=HAC%3A%20Hierarchical%20Agglomerative%20Clustering.%20Is%20It%20Better%20Than%20K-Means%3F)
- [Share on X](https://x.com/share?url=https%3A%2F%2Ftowardsdatascience.com%2Fhac-hierarchical-agglomerative-clustering-is-it-better-than-k-means-4ff6f459e390%2F&text=HAC%3A%20Hierarchical%20Agglomerative%20Clustering.%20Is%20It%20Better%20Than%20K-Means%3F)

Towards Data Science is a community publication. Submit your insights to reach our global audience and earn through the TDS Author Payment Program.

[Write for TDS](https://towardsdatascience.com/questions-96667b06af5/)

## Related Articles

- ![](https://towardsdatascience.com/wp-content/uploads/2024/08/0c09RmbCCpfjAbSMq.png)





## [Implementing Convolutional Neural Networks in TensorFlow](https://towardsdatascience.com/implementing-convolutional-neural-networks-in-tensorflow-bc1c4f00bd34/)

[Artificial Intelligence](https://towardsdatascience.com/category/artificial-intelligence/)





Step-by-step code guide to building a Convolutional Neural Network









[Shreya Rao](https://towardsdatascience.com/author/shreya-rao/)





August 20, 2024




6 min read

- ![Photo by Krista Mangulsone on Unsplash](https://towardsdatascience.com/wp-content/uploads/2024/08/0GyVVTbgotH-DhGPH-scaled.jpg)





## [How to Forecast Hierarchical Time Series](https://towardsdatascience.com/how-to-forecast-hierarchical-time-series-75f223f79793/)

[Artificial Intelligence](https://towardsdatascience.com/category/artificial-intelligence/)





A beginnerâ€™s guide to forecast reconciliation









[Dr. Robert KÃ¼bler](https://towardsdatascience.com/author/dr-robert-kuebler/)





August 20, 2024




13 min read

- ![Photo by davisuko on Unsplash](https://towardsdatascience.com/wp-content/uploads/2024/08/1bAABgtZtAIG5YW1oEjW3pA-scaled.jpeg)





## [Hands-on Time Series Anomaly Detection using Autoencoders, with Python](https://towardsdatascience.com/hands-on-time-series-anomaly-detection-using-autoencoders-with-python-7cd893bbc122/)

[Data Science](https://towardsdatascience.com/category/data-science/)





Hereâ€™s how to use Autoencoders to detect signals with anomalies in a few lines ofâ€¦









[Piero Paialunga](https://towardsdatascience.com/author/piero-paialunga/)





August 21, 2024




12 min read

- ![Image from Canva.](https://towardsdatascience.com/wp-content/uploads/2024/08/1UAA9jQVdqMXnwzYiz8Q53Q.png)





## [3 AI Use Cases (That Are Not a Chatbot)](https://towardsdatascience.com/3-ai-use-cases-that-are-not-a-chatbot-f4f328a2707a/)

[Machine Learning](https://towardsdatascience.com/category/artificial-intelligence/machine-learning/)





Feature engineering, structuring unstructured data, and lead scoring









[Shaw Talebi](https://towardsdatascience.com/author/shawhin/)





August 21, 2024




7 min read

- ## [Solving a Constrained Project Scheduling Problem with Quantum Annealing](https://towardsdatascience.com/solving-a-constrained-project-scheduling-problem-with-quantum-annealing-d0640e657a3b/)

[Data Science](https://towardsdatascience.com/category/data-science/)





Solving the resource constrained project scheduling problem (RCPSP) with D-Waveâ€™s hybrid constrained quadratic model (CQM)









[Luis Fernando PÃ‰REZ ARMAS, Ph.D.](https://towardsdatascience.com/author/luisfernandopa1212/)





August 20, 2024




29 min read

- ![](https://towardsdatascience.com/wp-content/uploads/2023/02/1VEUgT5T4absnTqBMOEuNig.png)





## [Back To Basics, Part Uno: Linear Regression and Cost Function](https://towardsdatascience.com/back-to-basics-part-uno-linear-regression-cost-function-and-gradient-descent-590dcb3eee46/)

[Data Science](https://towardsdatascience.com/category/data-science/)





An illustrated guide on essential machine learning concepts









[Shreya Rao](https://towardsdatascience.com/author/shreya-rao/)





February 3, 2023




6 min read

- ![](https://towardsdatascience.com/wp-content/uploads/2024/08/1kM8tfYcdaoccB1HX71YDig.png)





## [Must-Know in Statistics: The Bivariate Normal Projection Explained](https://towardsdatascience.com/must-know-in-statistics-the-bivariate-normal-projection-explained-ace7b2f70b5b/)

[Data Science](https://towardsdatascience.com/category/data-science/)





Derivation and practical examples of this powerful concept









[Luigi Battistoni](https://towardsdatascience.com/author/lu-battistoni/)





August 14, 2024




7 min read


Some areas of this page may shift around if you resize the browser window. Be sure to check heading and document order.